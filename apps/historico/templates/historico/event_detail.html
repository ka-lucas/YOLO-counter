{% extends 'home/base.html' %}

{% block page_title %}Detalhes do Evento{% endblock %}

{% block content %}

<div class="event-detail-card">
  <div class="event-header">
    <h2>Detalhes do Evento de Contagem</h2>
    <a href="{% url 'historico:historico' %}" class="back-link">← Voltar</a>
  </div>

  <div class="event-content">
    <div class="event-field">
      <label>Data/Hora:</label>
      <span>{{ event.timestamp|date:"d/m/Y H:i:s" }}</span>
    </div>

    <div class="event-field">
      <label>Direção:</label>
      <span class="direction-badge {% if event.direction == 'IN' %}in{% else %}out{% endif %}">
        {{ event.get_direction_display }}
      </span>
    </div>

    <div class="event-field">
      <label>Tipo de Animal:</label>
      <span>{{ event.animal_type }}</span>
    </div>

    <div class="event-field">
      <label>Confiança:</label>
      <span class="confidence">{{ event.confidence|floatformat:3 }} ({{ event.confidence|floatformat:1|mul:100 }}%)</span>
    </div>

    <div class="event-field">
      <label>Posição X:</label>
      <span>{{ event.position_x }} pixels</span>
    </div>

    <div class="event-field">
      <label>Posição Y:</label>
      <span>{{ event.position_y }} pixels</span>
    </div>

    <div class="event-field">
      <label>Número do Frame:</label>
      <span>{{ event.frame_number }}</span>
    </div>

    {% if event.video_source %}
    <div class="event-field">
      <label>Fonte do Vídeo:</label>
      <span>{{ event.video_source }}</span>
    </div>
    {% endif %}

    {% if event.user %}
    <div class="event-field">
      <label>Usuário:</label>
      <span>{{ event.user.username }}</span>
    </div>
    {% endif %}
  </div>

  <div class="event-visualization">
    <h3>Visualização da Posição</h3>
    <div class="position-display">
      <div class="frame-representation">
        <div class="detection-point" style="left: {{ event.position_x|div:10 }}px; top: {{ event.position_y|div:10 }}px;"></div>
        <span class="coordinates">{{ event.position_x }}, {{ event.position_y }}</span>
      </div>
    </div>
  </div>
</div>

{% endblock %}

{% block extra_css %}
<style>
.event-detail-card {
  background: white;
  border-radius: 8px;
  padding: 30px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.event-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 30px;
  padding-bottom: 20px;
  border-bottom: 1px solid #e5e7eb;
}

.back-link {
  color: #2dd4bf;
  text-decoration: none;
  padding: 8px 16px;
  border: 1px solid #2dd4bf;
  border-radius: 4px;
}

.back-link:hover {
  background: #2dd4bf;
  color: white;
}

.event-content {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
  margin-bottom: 30px;
}

.event-field {
  display: flex;
  flex-direction: column;
  gap: 5px;
}

.event-field label {
  font-weight: 600;
  color: #374151;
}

.event-field span {
  color: #6b7280;
}

.direction-badge {
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
  font-weight: 600;
  width: fit-content;
}

.direction-badge.in {
  background: #dcfdf7;
  color: #059669;
}

.direction-badge.out {
  background: #fef3c7;
  color: #d97706;
}

.confidence {
  font-family: monospace;
  font-weight: 600;
}

.event-visualization {
  border-top: 1px solid #e5e7eb;
  padding-top: 20px;
}

.event-visualization h3 {
  margin-bottom: 15px;
  color: #374151;
}

.position-display {
  background: #f9fafb;
  border: 1px solid #e5e7eb;
  border-radius: 4px;
  padding: 20px;
  text-align: center;
}

.frame-representation {
  position: relative;
  width: 300px;
  height: 200px;
  background: #1f2937;
  border-radius: 4px;
  margin: 0 auto;
  overflow: hidden;
}

.detection-point {
  position: absolute;
  width: 8px;
  height: 8px;
  background: #ef4444;
  border-radius: 50%;
  border: 2px solid white;
  transform: translate(-50%, -50%);
}

.coordinates {
  position: absolute;
  bottom: 10px;
  left: 50%;
  transform: translateX(-50%);
  color: white;
  font-size: 12px;
  font-family: monospace;
}
</style>
{% endblock %}